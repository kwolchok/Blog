---
# Documentation: https://wowchemy.com/docs/managing-content/

title: "Работа с библиографией."
subtitle: "Все, что нужно знать о работе с библиографией"
summary: ""
authors: [Волчок Кристина]
tags: []
categories: []
date: 2022-06-03T15:12:37+03:00
lastmod: 2022-06-03T15:12:37+03:00
featured: false
draft: false

# Featured image
# To use, add an image named `featured.jpg/png` to your page's folder.
# Focal points: Smart, Center, TopLeft, Top, TopRight, Left, Right, BottomLeft, Bottom, BottomRight.
image:
  caption: ""
  focal_point: ""
  preview_only: false

# Projects (optional).
#   Associate this post with one or more of your projects.
#   Simply enter your project's folder or file name without extension.
#   E.g. `projects = ["internal-project"]` references `content/project/deep-learning/index.md`.
#   Otherwise, set `projects = []`.
projects: []
---
Объектная модель Word включает несколько объектов, предназначенных для автоматизации создания библиографий. В следующей таблице перечислены основные объекты функции Библиографии Word. Используйте эти объекты и дополнительные свойства и методы в объектной модели Word, чтобы добавлять источники в списки источников, ссылаться на источники в документе и управлять источниками.
Понимание источника XML
Источники добавляются в исходные списки программным образом с помощью строк XML. В зависимости от типа источника, который необходимо добавить, структура XML изменяется. Чтобы определить структуру XML для типа источника, можно добавить один и тот же тип источника вручную, а затем просмотреть возвращенный XML. Ниже описано, как это сделать.
Элементы Guid и LCID необязательны, но при желании вы можете предоставить для них значения. Значение элемента Guid должно быть допустимым GUID, который можно создавать программным образом за пределами объектной модели Word. (См. Visual Studio документацию или документацию Windows MSDN для получения сведений о программном создании ID.) Word создает GUID-коды при добавлении или редактировании источника пользователями. Если вы не добавляете GUID в XML, а пользователь затем редактирует источник, Word создает GUID. Это позволяет Word определить, какой источник является самым последним, на основе значения GUID, и подсказок, хочет ли пользователь Word обновить устаревший источник для поддержания непрерывности между основным списком и текущим списком.

LCID указывает язык источника. (См. msDN для действительных значений идентификации языка.) Word использует LCID, чтобы узнать, как отображать приведенный источник в библиографии документа. Например, один источник может быть написан на французском языке, один на английском и один на японском. Из LCID Word определяет, как отобразить имена (например, Last, First for English), какую пунктуацию использовать (например, с помощью запятой на одном языке и запятой в другом) и какие строки использовать (например, использовать ли "et al" или другую локализованную форму).

После удаления необязательных элементов может быть структура, похожая на следующую структуру XML. (Вы можете определить, какие элементы необходимы, так как в диалоговом окне Create Source нет соответствующего редактируемого поля. Опущение одного или более необходимых элементов вызывает ошибку во время работы.)


Теперь, когда у вас есть базовая структура источника XML для книги, вы можете добавить дополнительные источники книг в основной исходный список и текущий список источников. Дополнительные элементы можно найти, проверив поле Показать все поля библиографии.
Добавление источников в список исходных данных и текущий список источников
Добавление источников в основной исходный список аналогично добавлению источников в текущий исходный список, за исключением доступа к коллекции Источников из различных основных объектов. Чтобы добавить источник в список исходных данных, вы можете получить доступ к коллекции Источников из свойства Bibliography объекта Application . Чтобы добавить источник в текущий исходный список, вы можете получить доступ к коллекции Источников из свойства библиографии объекта Document .

В следующем примере для добавления другого источника книги в основной исходный список используется базовая структура, определяемая ранее.
Строку можно изменить на Application.Bibliography.Sources.Add strXml``ActiveDocument.Bibliography.Sources.Add strXml

Включение источника программным путем в список исходных кодов не добавляет его автоматически в текущий исходный список. Однако, чтобы добавить цитату в документ, источник должен быть указан в текущем списке источников. Вы можете вручную скопировать один или несколько источников из мастер-списка в текущий список с помощью диалоговых окне Source Manager или программным образом скопировать один или несколько источников из основном списке в текущий список. В следующем примере копируется все источники в мастер-источнике в текущий источник. После того как источники будут добавлены в текущий список, в документ можно вставить ссылки для этих источников.
Поделитесь исходным списком
Иногда может потребоваться поделиться исходным списком с другими в организации. При добавлении источников в мастер-список Word добавляет их к именам файлов "sources.xml", расположенным по адресу C:\Users\<user>\AppData\Roaming\Microsoft\Bibliography\sources.xml. Вы можете поделиться этим файлом с другими пользователями, предоставляя им файл, который пользователи могут загружать вручную из диалогового окна Source Manager или программным образом через код.


Вставка цитирования
Вы можете вставить цитацию библиографии с помощью метода Add для коллекции Fields. В следующем примере в курсоре вставляется цитата для источника, добавленного ранее. Текст для поля равен значению тега или значению элемента Tag, который в данном случае является "Mor01". (См. код XML в субраутине AddBibSource, показанном ранее для строки XML "<b:Tag>Mor01</b:Tag>".) Значение элемента Tag также соответствует свойству Tag для объекта Source .

Применение стиля библиографии
После вставки библиографии в документ можно установить стиль библиографии. Word форматы нескольких различных стилей библиографий. Стиль библиографии можно установить с помощью свойства BibliographyStyle . Это свойство может быть одним из следующих значений String :

APA

Чикаго

GB7714

GOST — сортировка имен

GOST — сортировка названий

ISO 690 — дата первого элемента

ISO 690 — числовая справка

MLA

SISTO2

Turabian

Вставить библиографию
Как и в цитациях, в библиографиях используются поля. Чтобы вставить библиографию, необходимо вставить поле с константой wdFieldBibliography , указанной для типа поля. Следующий код вставляет библиографию в активный документ на курсоре. В этом примере предполагается, что курсор расположен в конце документа или на новой странице.

